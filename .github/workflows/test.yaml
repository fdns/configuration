name: Build ansible release

on: push

jobs:
  build:
    runs-on: ubuntu-16.04

    steps:
      - uses: actions/checkout@master
      
      - name: Remove extra packages
        run: |
          sudo apt-get purge mysql-server
      - name: Build edx
        run: |
          set -x
          export OPENEDX_RELEASE=master
          echo 'EDXAPP_LMS_BASE: "localhost"' > config.yml
          echo 'EDXAPP_CMS_BASE: "studio.localhost"' >> config.yml
          sudo bash util/install/ansible-bootstrap.sh
          bash util/install/generate-passwords.sh
          bash util/install/native.sh
